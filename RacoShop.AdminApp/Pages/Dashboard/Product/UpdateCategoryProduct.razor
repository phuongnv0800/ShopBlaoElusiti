<div class="simple-form" style="width: 220px">
    <select class="form-control mb-4" @bind="CategoryId">
        @if (Categories != null)
        {
            @foreach (var item in Categories)
            {
                <option value="@item.Id">@item.Name</option>
            }
        }

    </select>
    <button @onclick="CategoryAssign" class="btn btn-primary">Cập nhật</button>

    <button @onclick="ModalInstance.CancelAsync" class="btn btn-secondary">Huỷ bỏ</button>

</div>
@inject ICategoryApiClient CategoryApiClient
@inject IProductApiClient ProductApiClient
@inject IToastService ToastService
@code {
    [Parameter]
    public int Id { get; set; }

    [Parameter]
    public int CategoryId { get; set; }

    [CascadingParameter]
    BlazoredModalInstance ModalInstance { get; set; }

    public IEnumerable<CategoryVm> Categories { get; set; }


    protected override async Task OnInitializedAsync()
    {
        Categories = await CategoryApiClient.GetAll();
    }

    private async void CategoryAssign()
    {
        var result = await ProductApiClient.CategoryAssign(Id, CategoryId);
        if (result)
            ToastService.ShowSuccess($"Cập nhật sản phẩm", $"Thông báo");

        else
            ToastService.ShowError("Cập nhật không thành công", $"Thông báo");

        await ModalInstance.CloseAsync(ModalResult.Ok<string>("thành công"));
    }
}
